
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Submodules &#8212; Multiphase Reactor Modeling using PyMRM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=482b656a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pymrm/docs/sphinx/pymrm';</script>
    <link rel="icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../content/index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Multiphase Reactor Modeling using PyMRM - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Multiphase Reactor Modeling using PyMRM - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../content/index.html">
                    <svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-home" viewBox="0 0 16 16" aria-hidden="true"><path d="M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z"></path></svg> Multiphase Reactor Modeling using PyMRM
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../content/getting_started/getting_started.html">Getting Started with PyMRM</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/tutorials/tutorials.html">Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/introduction_and_start.html">Introduction to PyMRM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/stationary_diffusion.html">Stationary Diffusion Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/diffusion_first_order_kinetics.html">Diffusion: First-order Kinetics, Multi-Component, Unsteady</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/nonlinear_kinetics.html">Nonlinear Kinetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/diffusion_2D.html">2D Diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/diffusion_model_class.html">Diffusion-Reaction Class Implementation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/examples/examples.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/counter_diffusion_reaction.html">Counter diffusion and reaction in a slab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/particle_model_effectiveness.html">Particle model: diffusion + first order reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/counter_current_reaction.html">Counter-current convection and reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tvd.html">TVD schemes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/unsteady_diffusion_reaction_2D.html">Unsteady diffusion + reaction 1/2/3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/unsteady_convection_reaction.html">Unsteady convection + reaction 1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/darcy_flow.html">Darcy flow in a 2D domain with varying permeability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/lid_driven_cavity.html">Lid-driven cavity</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/exercises/index.html">Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/ode-solving-for-reactor-modeling.html">1. ODE Solving for Reactor Modeling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/first-order-reaction-in-a-batch-reactor.html">1.1. First order reaction in a batch reactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/equilibrium-consecutive-batch-reactions.html">1.2. Equilibrium consecutive batch reactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/steady-state-1d-fixed-bed-reactor-model-first-order-exothermal-reaction.html">1.3. Steady state 1D fixed bed reactor model: first order exothermal reaction</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/unsteady-convection-reaction-equations.html">2. Unsteady Convection-Reaction equations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/convection-of-one-species-using-different-schemes.html">2.1. Convection of one species using different schemes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/multicomponent-convection-reaction-with-first-order-chemical-kinetics.html">2.2. Multicomponent convection-reaction with first-order chemical kinetics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/multicomponent-convection-reaction-with-general-chemical-kinetics.html">2.3. Multicomponent convection-reaction with general chemical kinetics</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/implicit-convection-diffusion-reaction.html">3. Implicit convection-diffusion-reaction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/solving-a-one-component-1d-diffusion-reaction-equation.html">3.1. Solving a one-component 1D diffusion-reaction equation </a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/multi-component-1d-counter-diffusion-with-reaction.html">3.2. Multi-component 1D counter-diffusion with reaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/multi-component-1d-counter-current-convection-with-reaction.html">3.3. Multi-component 1D counter-current convection with reaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/convection-dispersion-reaction-in-a-1d-reactor-model.html">3.4. Convection-dispersion-reaction in a 1D reactor model </a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/particle-model-first-order-reaction.html">3.5. Particle model: first order reaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/weisz-and-hicks-model.html">3.6. Weisz and Hicks model</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/modeling-dispersion-and-mass-transfer.html">4. Modeling Dispersion and Mass Transfer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/counter-current-column-processes.html">4.1. Counter-current column processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/reactor-model-for-heterogeneous-bubble-columns.html">4.2. Reactor model for heterogeneous bubble columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/kunii-and-levenspiel-model-for-a-fine-particle-fluidized-bed.html">4.3. Kunii and Levenspiel model for a 'fine particle' fluidized bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/computing-residence-time-distributions.html">4.4. Computing residence time distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/the-westerterp-wave-model-for-axial-dispersion-in-packed-beds.html">4.5. The Westerterp wave-model for axial dispersion in packed beds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/modeling-a-desiccant-dryer.html">4.6. Modeling a desiccant dryer</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/2d-reactor-models.html">5. 2D Reactor Models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/axial-convection-with-radial-dispersion.html">5.1. Axial convection with radial dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/diffusion-reaction-in-a-cylindrical-pore.html">5.2. Diffusion-reaction in a cylindrical pore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/2d-membrane-fixed-bed-reactor-model.html">5.3. 2D Membrane Fixed Bed Reactor Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/steady-state-2d-fixed-bed-reactor-model-first-order-exothermal-reaction.html">5.4. Steady-state 2D fixed bed reactor model: first order exothermal reaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/a-2d-gas-solid-fluidized-bed.html">5.5. A 2D Gas-solid fluidized bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/a-2d-bubble-column-model.html">5.6. A 2D Bubble column model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/taylor-dispersion.html">5.7. Taylor Dispersion</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/generalized-maxwell-stefan-equations.html">6. Generalized Maxwell-Stefan equations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/ternary-diffusion-with-maxwell-stefan-equations.html">6.1. Ternary diffusion with Maxwell-Stefan equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/dehydrogenation-of-ethanol.html">6.2. Dehydrogenation of ethanol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/mass-transfer-limitations-using-maxwell-stefan-equations.html">6.3. Mass transfer limitations using Maxwell-Stefan equations</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/exercises/advanced-reactor-modeling.html">7. Advanced Reactor Modeling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/coupled-batch-reactor-and-particle-model.html">7.1. Coupled batch reactor and particle model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/particle-model-coupled-to-column-model.html">7.2. Particle model coupled to column model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/exercises/pressure-velocity-coupling-in-column-models.html">7.3. Pressure-velocity coupling in column models</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/api/api.html">Modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/overview/pymrm.grid.html">pymrm.grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/overview/pymrm.convect.html">pymrm.convect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/overview/pymrm.numjac.html">pymrm.numjac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/overview/pymrm.solve.html">pymrm.solve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/overview/pymrm.interpolate.html">pymrm.interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/overview/pymrm.operators.html">pymrm.operators</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../content/api/alphabetical_overview.html">All Functions and Classes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.clam.html">pymrm.convect.clam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.construct_convflux_upwind.html">pymrm.convect.construct_convflux_upwind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.construct_convflux_upwind_int.html">pymrm.convect.construct_convflux_upwind_int</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.minmod.html">pymrm.convect.minmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.muscl.html">pymrm.convect.muscl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.osher.html">pymrm.convect.osher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.smart.html">pymrm.convect.smart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.stoic.html">pymrm.convect.stoic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.upwind.html">pymrm.convect.upwind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.convect.vanleer.html">pymrm.convect.vanleer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.grid.generate_grid.html">pymrm.grid.generate_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.grid.non_uniform_grid.html">pymrm.grid.non_uniform_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.helpers.construct_coefficient_matrix.html">pymrm.helpers.construct_coefficient_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.interpolate.create_staggered_array.html">pymrm.interpolate.create_staggered_array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.interpolate.interp_cntr_to_stagg.html">pymrm.interpolate.interp_cntr_to_stagg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.interpolate.interp_cntr_to_stagg_tvd.html">pymrm.interpolate.interp_cntr_to_stagg_tvd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.interpolate.interp_stagg_to_cntr.html">pymrm.interpolate.interp_stagg_to_cntr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.numjac.NumJac.html">pymrm.numjac.NumJac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.numjac.stencil_block_diagonals.html">pymrm.numjac.stencil_block_diagonals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.operators.construct_div.html">pymrm.operators.construct_div</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.operators.construct_grad.html">pymrm.operators.construct_grad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.operators.construct_grad_bc.html">pymrm.operators.construct_grad_bc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.operators.construct_grad_int.html">pymrm.operators.construct_grad_int</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.solve.clip_approach.html">pymrm.solve.clip_approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../content/api/generated/all/pymrm.solve.newton.html">pymrm.solve.newton</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/eajfpeters/pymrm-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eajfpeters/pymrm-book/edit/main/_build/html/pymrm/docs/sphinx/pymrm.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/eajfpeters/pymrm-book/issues/new?title=Issue%20on%20page%20%2Fpymrm/docs/sphinx/pymrm.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/pymrm/docs/sphinx/pymrm.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Submodules</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.convect">pymrm.convect module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.clam"><code class="docutils literal notranslate"><span class="pre">clam()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.construct_convflux_bc"><code class="docutils literal notranslate"><span class="pre">construct_convflux_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.construct_convflux_upwind"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.construct_convflux_upwind_int"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.minmod"><code class="docutils literal notranslate"><span class="pre">minmod()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.muscl"><code class="docutils literal notranslate"><span class="pre">muscl()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.osher"><code class="docutils literal notranslate"><span class="pre">osher()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.smart"><code class="docutils literal notranslate"><span class="pre">smart()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.stoic"><code class="docutils literal notranslate"><span class="pre">stoic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.upwind"><code class="docutils literal notranslate"><span class="pre">upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.vanleer"><code class="docutils literal notranslate"><span class="pre">vanleer()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.grid">pymrm.grid module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-generation-submodule-for-pymrm">Grid Generation Submodule for pymrm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.grid.generate_grid"><code class="docutils literal notranslate"><span class="pre">generate_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.grid.non_uniform_grid"><code class="docutils literal notranslate"><span class="pre">non_uniform_grid()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.helpers">pymrm.helpers module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.helpers.construct_coefficient_matrix"><code class="docutils literal notranslate"><span class="pre">construct_coefficient_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.helpers.unwrap_bc_coeff"><code class="docutils literal notranslate"><span class="pre">unwrap_bc_coeff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.interpolate">pymrm.interpolate module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.compute_boundary_values"><code class="docutils literal notranslate"><span class="pre">compute_boundary_values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.create_staggered_array"><code class="docutils literal notranslate"><span class="pre">create_staggered_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.interp_cntr_to_stagg"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.interp_cntr_to_stagg_tvd"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg_tvd()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.interp_stagg_to_cntr"><code class="docutils literal notranslate"><span class="pre">interp_stagg_to_cntr()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.numjac">pymrm.numjac module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.NumJac"><code class="docutils literal notranslate"><span class="pre">NumJac</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.NumJac.init_stencil"><code class="docutils literal notranslate"><span class="pre">NumJac.init_stencil()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.colgroup"><code class="docutils literal notranslate"><span class="pre">colgroup()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.compute_df"><code class="docutils literal notranslate"><span class="pre">compute_df()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.compute_df2"><code class="docutils literal notranslate"><span class="pre">compute_df2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.expand_dependencies"><code class="docutils literal notranslate"><span class="pre">expand_dependencies()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.generate_sparsity_pattern"><code class="docutils literal notranslate"><span class="pre">generate_sparsity_pattern()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.group_columns_by_non_overlap_numba"><code class="docutils literal notranslate"><span class="pre">group_columns_by_non_overlap_numba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.iterate_over_entries"><code class="docutils literal notranslate"><span class="pre">iterate_over_entries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.precompute_perturbations"><code class="docutils literal notranslate"><span class="pre">precompute_perturbations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.precompute_perturbations_numba"><code class="docutils literal notranslate"><span class="pre">precompute_perturbations_numba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.ravel_index_numba"><code class="docutils literal notranslate"><span class="pre">ravel_index_numba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.stencil_block_diagonals"><code class="docutils literal notranslate"><span class="pre">stencil_block_diagonals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.unravel_index_numba"><code class="docutils literal notranslate"><span class="pre">unravel_index_numba()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.operators">pymrm.operators module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_div"><code class="docutils literal notranslate"><span class="pre">construct_div()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_grad"><code class="docutils literal notranslate"><span class="pre">construct_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_grad_bc"><code class="docutils literal notranslate"><span class="pre">construct_grad_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_grad_int"><code class="docutils literal notranslate"><span class="pre">construct_grad_int()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.solve">pymrm.solve module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.solve.clip_approach"><code class="docutils literal notranslate"><span class="pre">clip_approach()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.solve.newton"><code class="docutils literal notranslate"><span class="pre">newton()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.NumJac"><code class="docutils literal notranslate"><span class="pre">NumJac</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.NumJac.init_stencil"><code class="docutils literal notranslate"><span class="pre">NumJac.init_stencil()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.clam"><code class="docutils literal notranslate"><span class="pre">clam()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.clip_approach"><code class="docutils literal notranslate"><span class="pre">clip_approach()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.compute_boundary_values"><code class="docutils literal notranslate"><span class="pre">compute_boundary_values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_coefficient_matrix"><code class="docutils literal notranslate"><span class="pre">construct_coefficient_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_convflux_bc"><code class="docutils literal notranslate"><span class="pre">construct_convflux_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_convflux_upwind"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_convflux_upwind_int"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_div"><code class="docutils literal notranslate"><span class="pre">construct_div()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_grad"><code class="docutils literal notranslate"><span class="pre">construct_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_grad_bc"><code class="docutils literal notranslate"><span class="pre">construct_grad_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_grad_int"><code class="docutils literal notranslate"><span class="pre">construct_grad_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_interface_matrices"><code class="docutils literal notranslate"><span class="pre">construct_interface_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.create_staggered_array"><code class="docutils literal notranslate"><span class="pre">create_staggered_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.generate_grid"><code class="docutils literal notranslate"><span class="pre">generate_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interp_cntr_to_stagg"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interp_cntr_to_stagg_tvd"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg_tvd()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interp_stagg_to_cntr"><code class="docutils literal notranslate"><span class="pre">interp_stagg_to_cntr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.minmod"><code class="docutils literal notranslate"><span class="pre">minmod()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.muscl"><code class="docutils literal notranslate"><span class="pre">muscl()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.newton"><code class="docutils literal notranslate"><span class="pre">newton()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.non_uniform_grid"><code class="docutils literal notranslate"><span class="pre">non_uniform_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.osher"><code class="docutils literal notranslate"><span class="pre">osher()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.smart"><code class="docutils literal notranslate"><span class="pre">smart()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.stencil_block_diagonals"><code class="docutils literal notranslate"><span class="pre">stencil_block_diagonals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.stoic"><code class="docutils literal notranslate"><span class="pre">stoic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.translate_indices_to_larger_array"><code class="docutils literal notranslate"><span class="pre">translate_indices_to_larger_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.update_csc_array_indices"><code class="docutils literal notranslate"><span class="pre">update_csc_array_indices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.upwind"><code class="docutils literal notranslate"><span class="pre">upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.vanleer"><code class="docutils literal notranslate"><span class="pre">vanleer()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="submodules">
<h1>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h1>
<section id="module-pymrm.convect">
<span id="pymrm-convect-module"></span><h2>pymrm.convect module<a class="headerlink" href="#module-pymrm.convect" title="Link to this heading">#</a></h2>
<p>convection.py</p>
<p>This submodule of pymrm provides functions to construct convective flux matrices using
upwind schemes and apply Total Variation Diminishing (TVD) limiters for numerical stability.</p>
<p>Functions:
- construct_convflux_upwind: Constructs the convective flux matrix using the upwind scheme.
- construct_convflux_upwind_int: Constructs the internal convective flux matrix.
- construct_convflux_bc: Constructs the convective flux matrix for boundary conditions.
- upwind: Upwind TVD limiter.
- minmod: Minmod TVD limiter.
- osher: Osher TVD limiter.
- clam: CLAM TVD limiter.
- muscl: MUSCL TVD limiter.
- smart: SMART TVD limiter.
- stoic: STOIC TVD limiter.
- vanleer: Van Leer TVD limiter.</p>
<p>Dependencies:
- numpy
- scipy.sparse (for csc_array)
- pymrm.grid (for optional grid generation)
- pymrm.helpers (for boundary condition handling)</p>
<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.clam">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">clam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#clam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.clam" title="Link to this definition">#</a></dt>
<dd><p>Applies the CLAM TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.construct_convflux_bc">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">construct_convflux_bc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#construct_convflux_bc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.construct_convflux_bc" title="Link to this definition">#</a></dt>
<dd><p>Constructs the convective flux matrix for boundary faces using the upwind scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the multi-dimensional array.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell-centered positions. If not provided, it is calculated based on the face array.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries for left and right boundaries. Default is (None, None).</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>)  Velocity array. Can be a scalar or an array.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis along which the numerical differentiation is performed. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition matrices. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convective flux matrix for internal faces.
csc_array: Convective flux matrix for boundary conditions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.construct_convflux_upwind">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">construct_convflux_upwind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#construct_convflux_upwind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.construct_convflux_upwind" title="Link to this definition">#</a></dt>
<dd><p>Constructs the convective flux matrix using the upwind scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> or </em><em>int</em>)  Shape of the multi-dimensional array. If an integer is provided, it is treated as 1D.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell positions. If not provided, it will be calculated based on the face array.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries for left and right boundaries. Default is (None, None).</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>)  Velocities on face positions. Can be a scalar or an array.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis along which the convection takes place. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition matrices. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convective flux matrix for internal faces.
csc_array: Convective flux matrix for boundary conditions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.construct_convflux_upwind_int">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">construct_convflux_upwind_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#construct_convflux_upwind_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.construct_convflux_upwind_int" title="Link to this definition">#</a></dt>
<dd><p>Constructs the convective flux matrix for internal faces using the upwind scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the multi-dimensional array.</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>)  Velocity array. Can be a scalar or an array.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis along which the numerical differentiation is performed. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convective flux matrix for internal faces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.minmod">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">minmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#minmod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.minmod" title="Link to this definition">#</a></dt>
<dd><p>Applies the Minmod TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.muscl">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">muscl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#muscl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.muscl" title="Link to this definition">#</a></dt>
<dd><p>Applies the MUSCL TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.osher">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">osher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#osher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.osher" title="Link to this definition">#</a></dt>
<dd><p>Applies the Osher TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.smart">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">smart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#smart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.smart" title="Link to this definition">#</a></dt>
<dd><p>Applies the SMART TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.stoic">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">stoic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#stoic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.stoic" title="Link to this definition">#</a></dt>
<dd><p>Applies the STOIC TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.upwind">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">upwind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#upwind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.upwind" title="Link to this definition">#</a></dt>
<dd><p>Applies the upwind TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.convect.vanleer">
<span class="sig-prename descclassname"><span class="pre">pymrm.convect.</span></span><span class="sig-name descname"><span class="pre">vanleer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#vanleer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.convect.vanleer" title="Link to this definition">#</a></dt>
<dd><p>Applies the van Leer TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pymrm.grid">
<span id="pymrm-grid-module"></span><h2>pymrm.grid module<a class="headerlink" href="#module-pymrm.grid" title="Link to this heading">#</a></h2>
<section id="grid-generation-submodule-for-pymrm">
<h3>Grid Generation Submodule for pymrm<a class="headerlink" href="#grid-generation-submodule-for-pymrm" title="Link to this heading">#</a></h3>
<p>This submodule provides essential functions for creating structured grids
used in multiphase reactor modeling. It includes uniform and non-uniform
grid generation methods.</p>
<p>Functions:
- non_uniform_grid: Generates a non-uniform grid with refined control over spacing.
- generate_grid: Constructs face-centered and optionally cell-centered grid positions.</p>
<p>Authors:
- E.A.J.F. Peters (TU/e)</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pymrm.grid.generate_grid">
<span class="sig-prename descclassname"><span class="pre">pymrm.grid.</span></span><span class="sig-name descname"><span class="pre">generate_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/grid.html#generate_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.grid.generate_grid" title="Link to this definition">#</a></dt>
<dd><p>Generate a structured grid with face and optional cell-centered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>)  Number of cells in the grid.</p></li>
<li><p><strong>x_f</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>)  Face-centered grid points. If None, a uniform grid is created.</p></li>
<li><p><strong>generate_x_c</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, generates cell-centered positions.</p></li>
<li><p><strong>x_c</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>)  User-defined cell-centered positions (optional).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Face positions (x_f)</p></li>
<li><p>Cell-centered positions (x_c) if <cite>generate_x_c</cite> is True</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.grid.non_uniform_grid">
<span class="sig-prename descclassname"><span class="pre">pymrm.grid.</span></span><span class="sig-name descname"><span class="pre">non_uniform_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx_inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/grid.html#non_uniform_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.grid.non_uniform_grid" title="Link to this definition">#</a></dt>
<dd><p>Generate a non-uniform grid of points in the interval [left_bound, right_bound].</p>
<p>This grid allows gradual spacing adjustments, refining or coarsening the mesh
based on a stretching factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_bound</strong> (<em>float</em>)  Start of the domain interval.</p></li>
<li><p><strong>right_bound</strong> (<em>float</em>)  End of the domain interval.</p></li>
<li><p><strong>num_points</strong> (<em>int</em>)  Number of face positions (including boundaries).</p></li>
<li><p><strong>dx_inf</strong> (<em>float</em>)  Asymptotic grid spacing for distant points.</p></li>
<li><p><strong>factor</strong> (<em>float</em>)  Stretching factor (&gt;1 for expansion, &lt;1 for compression).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of non-uniformly spaced grid points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pymrm.helpers">
<span id="pymrm-helpers-module"></span><h2>pymrm.helpers module<a class="headerlink" href="#module-pymrm.helpers" title="Link to this heading">#</a></h2>
<p>Helper functions for common operations in the pymrm package.</p>
<p>This module provides utility functions that support various operations across
different submodules, such as boundary condition handling, constructing coefficient
matrices, and creating staggered arrays for finite volume discretizations.</p>
<p>Functions:
- unwrap_bc_coeff: Process boundary coefficients for numerical schemes.
- construct_coefficient_matrix: Create diagonal coefficient matrices.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pymrm.helpers.construct_coefficient_matrix">
<span class="sig-prename descclassname"><span class="pre">pymrm.helpers.</span></span><span class="sig-name descname"><span class="pre">construct_coefficient_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/helpers.html#construct_coefficient_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.helpers.construct_coefficient_matrix" title="Link to this definition">#</a></dt>
<dd><p>Construct a diagonal matrix with coefficients on its diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coefficients</strong> (<em>ndarray</em><em> or </em><em>list</em>)  Values of the coefficients.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shape of the multidimensional field.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis for broadcasting in staggered grids.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sparse diagonal matrix of coefficients.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.helpers.unwrap_bc_coeff">
<span class="sig-prename descclassname"><span class="pre">pymrm.helpers.</span></span><span class="sig-name descname"><span class="pre">unwrap_bc_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/helpers.html#unwrap_bc_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.helpers.unwrap_bc_coeff" title="Link to this definition">#</a></dt>
<dd><p>Unwrap the boundary conditions for a given shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the domain.</p></li>
<li><p><strong>bc_coeff</strong> (<em>dict</em>)  Boundary condition coefficient, e.g., a, b, d.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unwrapped boundary condition coefficient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pymrm.interpolate">
<span id="pymrm-interpolate-module"></span><h2>pymrm.interpolate module<a class="headerlink" href="#module-pymrm.interpolate" title="Link to this heading">#</a></h2>
<p>Interpolate Submodule for pymrm</p>
<p>This submodule provides functions for interpolating values between staggered
and cell-centered grids, which is essential in finite-volume and finite-difference
schemes for solving partial differential equations. It includes standard linear
interpolation and Total Variation Diminishing (TVD) schemes to prevent numerical
oscillations in convective transport problems.</p>
<section id="functions">
<h3>Functions:<a class="headerlink" href="#functions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>interp_stagg_to_cntr(staggered_values, x_f, x_c=None, axis=0)</dt><dd><p>Linearly interpolate staggered grid values to cell-centered values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>interp_cntr_to_stagg(cell_centered_values, x_f, x_c=None, axis=0)</dt><dd><p>Linearly interpolate cell-centered values to staggered grid positions.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>interp_cntr_to_stagg_tvd(cell_centered_values, x_f, x_c=None, bc=None, v=0, tvd_limiter=None, axis=0)</dt><dd><p>Perform TVD interpolation from cell-centered values to staggered positions.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>create_staggered_array(array, shape, axis, x_f=None, x_c=None)</dt><dd><p>Generate staggered arrays for face-centered values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>compute_boundary_values(cell_centered_values, x_f, x_c=None, bc=None, axis=0)</dt><dd><p>Compute boundary values and gradients for cell-centered values.</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="dependencies">
<h3>Dependencies:<a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>numpy: For array manipulations.</p></li>
<li><p>pymrm.helpers: For boundary condition handling (<cite>unwrap_bc_coeff</cite>).</p></li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interpolate.compute_boundary_values">
<span class="sig-prename descclassname"><span class="pre">pymrm.interpolate.</span></span><span class="sig-name descname"><span class="pre">compute_boundary_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_centered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#compute_boundary_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interpolate.compute_boundary_values" title="Link to this definition">#</a></dt>
<dd><p>Compute boundary values and gradients for cell-centered values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_centered_values</strong> (<em>ndarray</em>)  Array of values at cell-centered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as dictionaries with keys a, b, and d.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to compute boundary values. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ndarray: Boundary values at the lower boundary.</p></li>
<li><p>ndarray: Gradients at the lower boundary.</p></li>
<li><p>ndarray: Boundary values at the upper boundary.</p></li>
<li><p>ndarray: Gradients at the upper boundary.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interpolate.create_staggered_array">
<span class="sig-prename descclassname"><span class="pre">pymrm.interpolate.</span></span><span class="sig-name descname"><span class="pre">create_staggered_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#create_staggered_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interpolate.create_staggered_array" title="Link to this definition">#</a></dt>
<dd><p>Generate a staggered array by broadcasting or interpolating face-centered values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>ndarray</em>)  Input array to be staggered.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the non-staggered cell-centered field.</p></li>
<li><p><strong>axis</strong> (<em>int</em>)  Axis along which staggering is applied.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell faces. Default is None.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Staggered array aligned with face positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interpolate.interp_cntr_to_stagg">
<span class="sig-prename descclassname"><span class="pre">pymrm.interpolate.</span></span><span class="sig-name descname"><span class="pre">interp_cntr_to_stagg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_centered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#interp_cntr_to_stagg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interpolate.interp_cntr_to_stagg" title="Link to this definition">#</a></dt>
<dd><p>Linearly interpolate values from cell-centered positions to staggered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_centered_values</strong> (<em>ndarray</em>)  Array of values at cell-centered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to interpolate. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated values at staggered positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interpolate.interp_cntr_to_stagg_tvd">
<span class="sig-prename descclassname"><span class="pre">pymrm.interpolate.</span></span><span class="sig-name descname"><span class="pre">interp_cntr_to_stagg_tvd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_centered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tvd_limiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#interp_cntr_to_stagg_tvd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interpolate.interp_cntr_to_stagg_tvd" title="Link to this definition">#</a></dt>
<dd><p>Perform TVD interpolation from cell-centered positions to staggered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_centered_values</strong> (<em>ndarray</em>)  Array of values at cell-centered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as dictionaries with keys a, b, and d.</p></li>
<li><p><strong>v</strong> (<em>ndarray</em><em> or </em><em>float</em><em>, </em><em>optional</em>)  Velocity field for upwinding. Default is 0.</p></li>
<li><p><strong>tvd_limiter</strong> (<em>callable</em><em>, </em><em>optional</em>)  TVD limiter function. Default is None.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to interpolate. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ndarray: Interpolated values at staggered positions.</p></li>
<li><p>ndarray: Delta values for TVD corrections.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interpolate.interp_stagg_to_cntr">
<span class="sig-prename descclassname"><span class="pre">pymrm.interpolate.</span></span><span class="sig-name descname"><span class="pre">interp_stagg_to_cntr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">staggered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#interp_stagg_to_cntr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interpolate.interp_stagg_to_cntr" title="Link to this definition">#</a></dt>
<dd><p>Linearly interpolate values from staggered positions to cell-centered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>staggered_values</strong> (<em>ndarray</em>)  Array of values at staggered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to interpolate. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated values at cell-centered positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pymrm.numjac">
<span id="pymrm-numjac-module"></span><h2>pymrm.numjac module<a class="headerlink" href="#module-pymrm.numjac" title="Link to this heading">#</a></h2>
<p>numjac.py</p>
<p>This module provides utilities for computing numerical Jacobians for multidimensional arrays.
It includes functions for generating sparsity patterns, grouping columns by non-overlapping rows,
and precomputing perturbations for efficient Jacobian computation.</p>
<p>Key Features:
- Expand dependencies into a uniform list of tuples in PyMRM dependency notation.
- Generate sparsity patterns for stencil-based numerical Jacobians.
- Group columns of sparse matrices by non-overlapping rows for efficient computation.
- Precompute perturbed values and compute differences in function values for Jacobian estimation.
- A <cite>NumJac</cite> class for encapsulating numerical Jacobian computation with customizable stencils.</p>
<p>Dependencies:
- NumPy
- SciPy
- Numba</p>
<dl class="py class">
<dt class="sig sig-object py" id="pymrm.numjac.NumJac">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">NumJac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_in=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stencil=&lt;function</span> <span class="pre">stencil_block_diagonals&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_jac=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#NumJac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.NumJac" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for computing numerical Jacobians for multidimensional arrays.</p>
<p>Attributes:
- shape_in (tuple): Shape of the input array.
- shape_out (tuple): Shape of the output array.
- eps_jac (float): Perturbation size for numerical Jacobian.
- dependencies (list): Stencil pattern in PyMRM dependency notation.
- rows (np.ndarray): Row indices for the sparse Jacobian.
- cols (np.ndarray): Column indices for the sparse Jacobian.
- gr (np.ndarray): Group array for column grouping.
- num_gr (int): Number of groups.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pymrm.numjac.NumJac.init_stencil">
<span class="sig-name descname"><span class="pre">init_stencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stencil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#NumJac.init_stencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.NumJac.init_stencil" title="Link to this definition">#</a></dt>
<dd><p>Initialize the stencil pattern.</p>
<p>Parameters:
- stencil (callable): Function to generate the stencil.
- <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs: Additional keyword arguments passed to the stencil function.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.colgroup">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">colgroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#colgroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.colgroup" title="Link to this definition">#</a></dt>
<dd><p>Group columns of a sparse matrix by non-overlapping rows.</p>
<p>Parameters:
- args: Sparse matrix or row/column indices.
- shape (tuple, optional): Shape of the sparse matrix.
- try_reorder (bool, optional): Whether to attempt reordering for fewer groups.</p>
<p>Returns:
- tuple: (group array, number of groups).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.compute_df">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">compute_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbed_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#compute_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.compute_df" title="Link to this definition">#</a></dt>
<dd><p>Compute the difference in function values for perturbed inputs.</p>
<p>Parameters:
- f_value (np.ndarray): Original function value.
- perturbed_values (np.ndarray): Function values for perturbed inputs.
- num_gr (int): Number of groups.</p>
<p>Returns:
- np.ndarray: Differences in function values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.compute_df2">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">compute_df2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#compute_df2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.compute_df2" title="Link to this definition">#</a></dt>
<dd><p>Compute the difference in function values for perturbed inputs by evaluating the function.</p>
<p>Parameters:
- f (callable): Function to evaluate.
- f_value (np.ndarray): Original function value.
- c_values (np.ndarray): Perturbed input values.
- num_gr (int): Number of groups.</p>
<p>Returns:
- np.ndarray: Differences in function values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.expand_dependencies">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">expand_dependencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependencies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#expand_dependencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.expand_dependencies" title="Link to this definition">#</a></dt>
<dd><p>Expand a given set of dependencies into a uniform list of tuples in the
PyMRM dependency notation, fully expanded.</p>
<p>Parameters:
- shape_in (tuple): Shape of the input array.
- shape_out (tuple): Shape of the output array.
- dependencies (list or tuple): List of dependencies in PyMRM dependency notation.</p>
<p>Returns:
- list: Fully expanded list of dependencies in the form (index_in, index_out, fixed_axes_list, periodic_axes_list).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.generate_sparsity_pattern">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">generate_sparsity_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependencies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#generate_sparsity_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.generate_sparsity_pattern" title="Link to this definition">#</a></dt>
<dd><p>Generate row and column indices for the sparse matrix representation of a stencil pattern.</p>
<p>Parameters:
- shape_in (tuple): Shape of the input array.
- shape_out (tuple): Shape of the output array.
- dependencies (list): List of dependencies in PyMRM dependency notation.</p>
<p>Returns:
- tuple: (row_indices, col_indices) for the sparse pattern.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.group_columns_by_non_overlap_numba">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">group_columns_by_non_overlap_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indptr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#group_columns_by_non_overlap_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.group_columns_by_non_overlap_numba" title="Link to this definition">#</a></dt>
<dd><p>Group columns of a sparse matrix by non-overlapping rows.</p>
<p>Parameters:
- indptr (np.ndarray): Index pointer array of the sparse matrix.
- indices (np.ndarray): Column indices of the sparse matrix.</p>
<p>Returns:
- tuple: (group array, number of groups).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.iterate_over_entries">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">iterate_over_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_rel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#iterate_over_entries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.iterate_over_entries" title="Link to this definition">#</a></dt>
<dd><p>Iterate over all valid relative entries defined by shape_rel and fill row_indices and col_indices.</p>
<p>Parameters:
- shape_in (np.ndarray): Shape of the input array.
- shape_out (np.ndarray): Shape of the output array.
- shape_rel (np.ndarray): Shape of the relative axes.
- idx_in (np.ndarray): Input position array.
- idx_out (np.ndarray): Output position array.
- row_indices (np.ndarray): Preallocated array for row indices.
- col_indices (np.ndarray): Preallocated array for column indices.
- entry_idx (int): Starting index in the row_indices/col_indices arrays.</p>
<p>Returns:
- int: Updated index after filling in entries.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.precompute_perturbations">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">precompute_perturbations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#precompute_perturbations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.precompute_perturbations" title="Link to this definition">#</a></dt>
<dd><p>Precompute perturbed values of the input array for numerical Jacobian computation.</p>
<p>Parameters:
- c (np.ndarray): Input array.
- dc (np.ndarray): Perturbation array.
- num_gr (int): Number of groups.
- gr (np.ndarray): Group array.</p>
<p>Returns:
- np.ndarray: Perturbed values of the input array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.precompute_perturbations_numba">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">precompute_perturbations_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#precompute_perturbations_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.precompute_perturbations_numba" title="Link to this definition">#</a></dt>
<dd><p>Precompute perturbed values of the input array using Numba for numerical Jacobian computation.</p>
<p>Parameters:
- c (np.ndarray): Input array.
- dc (np.ndarray): Perturbation array.
- num_gr (int): Number of groups.
- gr (np.ndarray): Group array.</p>
<p>Returns:
- np.ndarray: Perturbed values of the input array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.ravel_index_numba">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">ravel_index_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#ravel_index_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.ravel_index_numba" title="Link to this definition">#</a></dt>
<dd><p>Convert a multidimensional index to a flat index.</p>
<p>Parameters:
- shape (tuple): Shape of the multidimensional array.
- index (tuple): Multidimensional index.</p>
<p>Returns:
- int: Flat (linear) index.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.stencil_block_diagonals">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">stencil_block_diagonals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_diagonals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#stencil_block_diagonals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.stencil_block_diagonals" title="Link to this definition">#</a></dt>
<dd><p>Generate a stencil pattern for block diagonals.</p>
<p>Parameters:
- ndims (int): Number of dimensions.
- axes_diagonals (list): Axes for diagonal dependencies.
- axes_blocks (list): Axes for block dependencies.
- periodic_axes (list): Axes with periodic boundaries.</p>
<p>Returns:
- list: Stencil pattern in PyMRM dependency notation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.numjac.unravel_index_numba">
<span class="sig-prename descclassname"><span class="pre">pymrm.numjac.</span></span><span class="sig-name descname"><span class="pre">unravel_index_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lin_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#unravel_index_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.numjac.unravel_index_numba" title="Link to this definition">#</a></dt>
<dd><p>Convert a flat (linear) index to a multidimensional index.</p>
<p>Parameters:
- lin_idx (int): Flat index.
- shape (tuple): Shape of the multidimensional array.</p>
<p>Returns:
- np.ndarray: Multidimensional index.</p>
</dd></dl>

</section>
<section id="module-pymrm.operators">
<span id="pymrm-operators-module"></span><h2>pymrm.operators module<a class="headerlink" href="#module-pymrm.operators" title="Link to this heading">#</a></h2>
<p>Operators Submodule for pymrm</p>
<p>This submodule provides numerical operators for spatial discretization,
including gradient and divergence operators.
These operators are essential for constructing finite difference
and finite volume schemes used in multiphase reactor modeling.</p>
<p>Functions:
- construct_grad: Constructs the gradient matrix for spatial differentiation.
- construct_grad_int: Constructs the gradient matrix for internal faces.
- construct_grad_bc: Constructs the gradient matrix for boundary faces.
- construct_div: Constructs the divergence matrix for flux calculations.</p>
<p>Dependencies:
- numpy
- scipy.sparse
- pymrm.grid (for optional grid generation)
- pymrm.helpers (for boundary condition handling)</p>
<dl class="py function">
<dt class="sig sig-object py" id="pymrm.operators.construct_div">
<span class="sig-prename descclassname"><span class="pre">pymrm.operators.</span></span><span class="sig-name descname"><span class="pre">construct_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.operators.construct_div" title="Link to this definition">#</a></dt>
<dd><p>Construct the divergence matrix for flux calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> or </em><em>int</em>)  Shape of the domain. If an integer is provided, it is converted to a tuple.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>nu</strong> (<em>int</em><em> or </em><em>callable</em><em>, </em><em>optional</em>)  Geometry factor (0: flat, 1: cylindrical, 2: spherical, or a callable for custom geometry). Default is 0.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which divergence is computed. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Divergence matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.operators.construct_grad">
<span class="sig-prename descclassname"><span class="pre">pymrm.operators.</span></span><span class="sig-name descname"><span class="pre">construct_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.operators.construct_grad" title="Link to this definition">#</a></dt>
<dd><p>Construct the gradient matrix for spatial differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> or </em><em>int</em>)  Shape of the domain. If an integer is provided, it is converted to a tuple.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell center coordinates. If not provided, they are calculated.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries. Default is (None, None).</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis of differentiation. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition contributions. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradient matrix.
csc_array or tuple: Gradient contribution from boundary conditions. If <cite>shapes_d</cite> is provided, returns a tuple.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.operators.construct_grad_bc">
<span class="sig-prename descclassname"><span class="pre">pymrm.operators.</span></span><span class="sig-name descname"><span class="pre">construct_grad_bc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_grad_bc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.operators.construct_grad_bc" title="Link to this definition">#</a></dt>
<dd><p>Construct the gradient matrix for boundary faces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the domain.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face coordinates.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell center coordinates. If not provided, they are calculated.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries. Default is (None, None).</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis of differentiation. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition contributions. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Gradient matrix for boundary faces and contributions from inhomogeneous boundary conditions.</dt><dd><p>If <cite>shapes_d</cite> is provided, returns a tuple of matrices.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array or tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.operators.construct_grad_int">
<span class="sig-prename descclassname"><span class="pre">pymrm.operators.</span></span><span class="sig-name descname"><span class="pre">construct_grad_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_grad_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.operators.construct_grad_int" title="Link to this definition">#</a></dt>
<dd><p>Construct the gradient matrix for internal faces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the domain.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face coordinates.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell center coordinates. If not provided, they are calculated.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis of differentiation. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradient matrix for internal faces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pymrm.solve">
<span id="pymrm-solve-module"></span><h2>pymrm.solve module<a class="headerlink" href="#module-pymrm.solve" title="Link to this heading">#</a></h2>
<p>The <cite>solve</cite> module provides numerical solvers for nonlinear systems, including
Newton-Raphson methods for efficiently solving systems of equations arising in
multiphase reactor modeling.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pymrm.solve.clip_approach">
<span class="sig-prename descclassname"><span class="pre">pymrm.solve.</span></span><span class="sig-name descname"><span class="pre">clip_approach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/solve.html#clip_approach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.solve.clip_approach" title="Link to this definition">#</a></dt>
<dd><p>Apply bounds and an approach factor to an array of values.</p>
<p>This function modifies the input array <cite>values</cite> in-place by applying lower
and upper bounds. If an approach factor is specified, values outside the
bounds are adjusted proportionally to the factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>ndarray</em>)  The array of values to be modified.</p></li>
<li><p><strong>function</strong> (<em>callable</em>)  A function to apply to the values (not used in the
current implementation but reserved for future extensions).</p></li>
<li><p><strong>lower_bounds</strong> (<em>float</em><em> or </em><em>ndarray</em><em>, </em><em>optional</em>)  The lower bounds for the values.
Can be a scalar or an array of the same shape as <cite>values</cite>. Default is 0.</p></li>
<li><p><strong>upper_bounds</strong> (<em>float</em><em> or </em><em>ndarray</em><em>, </em><em>optional</em>)  The upper bounds for the values.
Can be a scalar or an array of the same shape as <cite>values</cite>. Default is None.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>)  The approach factor. If 0, values are clipped
directly to the bounds. If non-zero, values outside the bounds are
adjusted proportionally. Default is 0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function modifies the <cite>values</cite> array in-place.</p></li>
<li><p>If <cite>lower_bounds</cite> or <cite>upper_bounds</cite> are not specified, they are ignored.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.solve.newton">
<span class="sig-prename descclassname"><span class="pre">pymrm.solve.</span></span><span class="sig-name descname"><span class="pre">newton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.49012e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/solve.html#newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.solve.newton" title="Link to this definition">#</a></dt>
<dd><p>Perform Newton-Raphson iterations to solve nonlinear systems of equations.</p>
<p>This method iteratively refines an initial guess to find the root of a system
of nonlinear equations. It supports various linear solvers for handling the
Jacobian matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<em>callable</em>)  A function that takes the current solution estimate
and additional arguments, and returns a tuple containing the residual
vector and the Jacobian matrix.</p></li>
<li><p><strong>initial_guess</strong> (<em>ndarray</em>)  Initial guess for the solution vector.</p></li>
<li><p><strong>args</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Additional arguments to pass to the <cite>function</cite>.
Default is an empty tuple.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>)  Convergence tolerance for the solution. Iterations
stop when the infinity norm of the update vector is less than <cite>tol</cite>.
Default is 1.49012e-08.</p></li>
<li><p><strong>maxfev</strong> (<em>int</em><em>, </em><em>optional</em>)  Maximum number of iterations allowed. Default is 100.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>optional</em>)  Linear solver to use for solving the Jacobian system.
Options are spsolve, cg, or bicgstab. If not specified, spsolve
is used for small systems (n &lt; 50000), and bicgstab for larger systems.</p></li>
<li><p><strong>callback</strong> (<em>callable</em><em>, </em><em>optional</em>)  A function called after each iteration with
the current solution estimate and residual vector as arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An object containing the following fields:</dt><dd><ul class="simple">
<li><p>x (ndarray): The solution vector.</p></li>
<li><p>success (bool): Whether the solver converged.</p></li>
<li><p>nit (int): Number of iterations performed.</p></li>
<li><p>fun (ndarray): The residual vector at the solution.</p></li>
<li><p>message (str): A message describing the termination status.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OptimizeResult</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong>  If an unsupported solver method is specified.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pymrm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pymrm" title="Link to this heading">#</a></h2>
<p>pymrm: A Python Package for Multiphase Reactor Modeling</p>
<p>This package provides a comprehensive set of tools for modeling multiphase reactors,
including grid generation, numerical operators, convection schemes, interpolation methods,
nonlinear solvers, and utility functions.</p>
<p>Submodules:
- grid: Functions for generating uniform and non-uniform grids.
- operator: Construction of gradient and divergence operators for finite volume methods.
- convection: High-resolution convection schemes and TVD limiters.
- interpolate: Interpolation techniques between staggered and cell-centered grids.
- solve: Nonlinear solvers and numerical approaches.
- helpers: Utility functions supporting core operations.
- numjac: Numerical Jacobian construction for nonlinear systems.</p>
<p>Example Usage:
.. code-block:: python</p>
<blockquote>
<div><p>import numpy as np
import matplotlib.pyplot as plt
from pymrm import construct_grad, construct_div</p>
<p># Define the grid
shape = (100,)
x_f = np.linspace(0, 1, shape[0]+1)
x_c = 0.5*(x_f[1:] + x_f[:-1])</p>
<p># Set boundary conditions
bc_L = {a: 0, b:1, d:1}
bc_R = {a: 0, b:1, d:0}
grad_mat, grad_bc = construct_grad(shape, x_f, x_c, bc=(bc_L, bc_R))
div_mat = construct_div(shape, x_f)
lapl_mat = div_mat &#64; grad_mat
lapl_bc = div_mat &#64; grad_bc</p>
<p>c = np.zeros(shape)
c[:] = lapl_mat.solve(lapl_bc)
plt.plot(x_c, c)</p>
</div></blockquote>
<p>Authors:
- E.A.J.F. Peters
- M. van Sint Annaland
- M. Galanti
- D.R. Rieder</p>
<p>License: MIT License</p>
<dl class="py class">
<dt class="sig sig-object py" id="pymrm.NumJac">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">NumJac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_in=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stencil=&lt;function</span> <span class="pre">stencil_block_diagonals&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_jac=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#NumJac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.NumJac" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for computing numerical Jacobians for multidimensional arrays.</p>
<p>Attributes:
- shape_in (tuple): Shape of the input array.
- shape_out (tuple): Shape of the output array.
- eps_jac (float): Perturbation size for numerical Jacobian.
- dependencies (list): Stencil pattern in PyMRM dependency notation.
- rows (np.ndarray): Row indices for the sparse Jacobian.
- cols (np.ndarray): Column indices for the sparse Jacobian.
- gr (np.ndarray): Group array for column grouping.
- num_gr (int): Number of groups.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pymrm.NumJac.init_stencil">
<span class="sig-name descname"><span class="pre">init_stencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stencil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#NumJac.init_stencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.NumJac.init_stencil" title="Link to this definition">#</a></dt>
<dd><p>Initialize the stencil pattern.</p>
<p>Parameters:
- stencil (callable): Function to generate the stencil.
- <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs: Additional keyword arguments passed to the stencil function.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.clam">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">clam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#clam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.clam" title="Link to this definition">#</a></dt>
<dd><p>Applies the CLAM TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.clip_approach">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">clip_approach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/solve.html#clip_approach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.clip_approach" title="Link to this definition">#</a></dt>
<dd><p>Apply bounds and an approach factor to an array of values.</p>
<p>This function modifies the input array <cite>values</cite> in-place by applying lower
and upper bounds. If an approach factor is specified, values outside the
bounds are adjusted proportionally to the factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>ndarray</em>)  The array of values to be modified.</p></li>
<li><p><strong>function</strong> (<em>callable</em>)  A function to apply to the values (not used in the
current implementation but reserved for future extensions).</p></li>
<li><p><strong>lower_bounds</strong> (<em>float</em><em> or </em><em>ndarray</em><em>, </em><em>optional</em>)  The lower bounds for the values.
Can be a scalar or an array of the same shape as <cite>values</cite>. Default is 0.</p></li>
<li><p><strong>upper_bounds</strong> (<em>float</em><em> or </em><em>ndarray</em><em>, </em><em>optional</em>)  The upper bounds for the values.
Can be a scalar or an array of the same shape as <cite>values</cite>. Default is None.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>)  The approach factor. If 0, values are clipped
directly to the bounds. If non-zero, values outside the bounds are
adjusted proportionally. Default is 0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function modifies the <cite>values</cite> array in-place.</p></li>
<li><p>If <cite>lower_bounds</cite> or <cite>upper_bounds</cite> are not specified, they are ignored.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.compute_boundary_values">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">compute_boundary_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_centered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#compute_boundary_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.compute_boundary_values" title="Link to this definition">#</a></dt>
<dd><p>Compute boundary values and gradients for cell-centered values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_centered_values</strong> (<em>ndarray</em>)  Array of values at cell-centered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as dictionaries with keys a, b, and d.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to compute boundary values. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ndarray: Boundary values at the lower boundary.</p></li>
<li><p>ndarray: Gradients at the lower boundary.</p></li>
<li><p>ndarray: Boundary values at the upper boundary.</p></li>
<li><p>ndarray: Gradients at the upper boundary.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_coefficient_matrix">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_coefficient_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/helpers.html#construct_coefficient_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_coefficient_matrix" title="Link to this definition">#</a></dt>
<dd><p>Construct a diagonal matrix with coefficients on its diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coefficients</strong> (<em>ndarray</em><em> or </em><em>list</em>)  Values of the coefficients.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shape of the multidimensional field.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis for broadcasting in staggered grids.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sparse diagonal matrix of coefficients.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_convflux_bc">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_convflux_bc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#construct_convflux_bc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_convflux_bc" title="Link to this definition">#</a></dt>
<dd><p>Constructs the convective flux matrix for boundary faces using the upwind scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the multi-dimensional array.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell-centered positions. If not provided, it is calculated based on the face array.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries for left and right boundaries. Default is (None, None).</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>)  Velocity array. Can be a scalar or an array.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis along which the numerical differentiation is performed. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition matrices. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convective flux matrix for internal faces.
csc_array: Convective flux matrix for boundary conditions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_convflux_upwind">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_convflux_upwind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#construct_convflux_upwind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_convflux_upwind" title="Link to this definition">#</a></dt>
<dd><p>Constructs the convective flux matrix using the upwind scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> or </em><em>int</em>)  Shape of the multi-dimensional array. If an integer is provided, it is treated as 1D.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell positions. If not provided, it will be calculated based on the face array.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries for left and right boundaries. Default is (None, None).</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>)  Velocities on face positions. Can be a scalar or an array.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis along which the convection takes place. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition matrices. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convective flux matrix for internal faces.
csc_array: Convective flux matrix for boundary conditions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_convflux_upwind_int">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_convflux_upwind_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#construct_convflux_upwind_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_convflux_upwind_int" title="Link to this definition">#</a></dt>
<dd><p>Constructs the convective flux matrix for internal faces using the upwind scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the multi-dimensional array.</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>)  Velocity array. Can be a scalar or an array.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  The axis along which the numerical differentiation is performed. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convective flux matrix for internal faces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_div">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_div" title="Link to this definition">#</a></dt>
<dd><p>Construct the divergence matrix for flux calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> or </em><em>int</em>)  Shape of the domain. If an integer is provided, it is converted to a tuple.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>nu</strong> (<em>int</em><em> or </em><em>callable</em><em>, </em><em>optional</em>)  Geometry factor (0: flat, 1: cylindrical, 2: spherical, or a callable for custom geometry). Default is 0.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which divergence is computed. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Divergence matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_grad">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_grad" title="Link to this definition">#</a></dt>
<dd><p>Construct the gradient matrix for spatial differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> or </em><em>int</em>)  Shape of the domain. If an integer is provided, it is converted to a tuple.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face positions.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell center coordinates. If not provided, they are calculated.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries. Default is (None, None).</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis of differentiation. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition contributions. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradient matrix.
csc_array or tuple: Gradient contribution from boundary conditions. If <cite>shapes_d</cite> is provided, returns a tuple.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_grad_bc">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_grad_bc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_grad_bc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_grad_bc" title="Link to this definition">#</a></dt>
<dd><p>Construct the gradient matrix for boundary faces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the domain.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face coordinates.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell center coordinates. If not provided, they are calculated.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as a tuple of dictionaries. Default is (None, None).</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis of differentiation. Default is 0.</p></li>
<li><p><strong>shapes_d</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Shapes for boundary condition contributions. Default is (None, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Gradient matrix for boundary faces and contributions from inhomogeneous boundary conditions.</dt><dd><p>If <cite>shapes_d</cite> is provided, returns a tuple of matrices.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array or tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_grad_int">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_grad_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/operators.html#construct_grad_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_grad_int" title="Link to this definition">#</a></dt>
<dd><p>Construct the gradient matrix for internal faces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the domain.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Face coordinates.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Cell center coordinates. If not provided, they are calculated.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis of differentiation. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradient matrix for internal faces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csc_array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.construct_interface_matrices">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">construct_interface_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">({'a':</span> <span class="pre">(1,</span> <span class="pre">1),</span> <span class="pre">'b':</span> <span class="pre">(0,</span> <span class="pre">0),</span> <span class="pre">'d':</span> <span class="pre">0},</span> <span class="pre">{'a':</span> <span class="pre">(0,</span> <span class="pre">0),</span> <span class="pre">'b':</span> <span class="pre">(1,</span> <span class="pre">-1),</span> <span class="pre">'d':</span> <span class="pre">0})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/coupling.html#construct_interface_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.construct_interface_matrices" title="Link to this definition">#</a></dt>
<dd><p>Construct sparse matrices for computing interface conditions between two coupled subdomains.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>shapes<span class="classifier">tuple of tuples</span></dt><dd><p>Shapes of the two subdomains.</p>
</dd>
<dt>x_fs<span class="classifier">tuple of arrays</span></dt><dd><p>Face-centered grid points for the two subdomains.</p>
</dd>
<dt>x_cs<span class="classifier">tuple of arrays, optional</span></dt><dd><p>Cell-centered grid points for the two subdomains. If None, they are computed internally (default: (None, None)).</p>
</dd>
<dt>ic<span class="classifier">tuple of dicts, optional</span></dt><dd><p>Interface conditions between the two subdomains, specified as:
- <cite>a</cite>: Coefficients for the normal derivative terms.
- <cite>b</cite>: Coefficients for the solution terms.
- <cite>d</cite>: Source term at the interface.
Defaults to conditions ensuring flux continuity.</p>
</dd>
<dt>axis<span class="classifier">int, optional</span></dt><dd><p>The axis along which the interface is constructed (default: 0).</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading">#</a></h3>
<p>:
interface_matrix_0 : scipy.sparse.csc_array</p>
<blockquote>
<div><p>Sparse matrix for computing interface values for the first subdomain.</p>
</div></blockquote>
<dl class="simple">
<dt>interface_bc_0<span class="classifier">scipy.sparse.csc_array</span></dt><dd><p>Sparse matrix for boundary conditions in the first subdomain.</p>
</dd>
<dt>interface_matrix_1<span class="classifier">scipy.sparse.csc_array</span></dt><dd><p>Sparse matrix for computing interface values for the second subdomain.</p>
</dd>
<dt>interface_bc_1<span class="classifier">scipy.sparse.csc_array</span></dt><dd><p>Sparse matrix for boundary conditions in the second subdomain.</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes:<a class="headerlink" href="#notes" title="Link to this heading">#</a></h3>
<p>This function constructs a fully implicit coupling between subdomains by ensuring the interface conditions
are directly included in the global system of equations. It prevents the need for iterative coupling
between domains, improving numerical stability.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.create_staggered_array">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">create_staggered_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#create_staggered_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.create_staggered_array" title="Link to this definition">#</a></dt>
<dd><p>Generate a staggered array by broadcasting or interpolating face-centered values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>ndarray</em>)  Input array to be staggered.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em>)  Shape of the non-staggered cell-centered field.</p></li>
<li><p><strong>axis</strong> (<em>int</em>)  Axis along which staggering is applied.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell faces. Default is None.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Staggered array aligned with face positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.generate_grid">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">generate_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/grid.html#generate_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.generate_grid" title="Link to this definition">#</a></dt>
<dd><p>Generate a structured grid with face and optional cell-centered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>)  Number of cells in the grid.</p></li>
<li><p><strong>x_f</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>)  Face-centered grid points. If None, a uniform grid is created.</p></li>
<li><p><strong>generate_x_c</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, generates cell-centered positions.</p></li>
<li><p><strong>x_c</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>)  User-defined cell-centered positions (optional).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Face positions (x_f)</p></li>
<li><p>Cell-centered positions (x_c) if <cite>generate_x_c</cite> is True</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interp_cntr_to_stagg">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">interp_cntr_to_stagg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_centered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#interp_cntr_to_stagg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interp_cntr_to_stagg" title="Link to this definition">#</a></dt>
<dd><p>Linearly interpolate values from cell-centered positions to staggered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_centered_values</strong> (<em>ndarray</em>)  Array of values at cell-centered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to interpolate. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated values at staggered positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interp_cntr_to_stagg_tvd">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">interp_cntr_to_stagg_tvd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_centered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tvd_limiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#interp_cntr_to_stagg_tvd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interp_cntr_to_stagg_tvd" title="Link to this definition">#</a></dt>
<dd><p>Perform TVD interpolation from cell-centered positions to staggered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_centered_values</strong> (<em>ndarray</em>)  Array of values at cell-centered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Boundary conditions as dictionaries with keys a, b, and d.</p></li>
<li><p><strong>v</strong> (<em>ndarray</em><em> or </em><em>float</em><em>, </em><em>optional</em>)  Velocity field for upwinding. Default is 0.</p></li>
<li><p><strong>tvd_limiter</strong> (<em>callable</em><em>, </em><em>optional</em>)  TVD limiter function. Default is None.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to interpolate. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ndarray: Interpolated values at staggered positions.</p></li>
<li><p>ndarray: Delta values for TVD corrections.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.interp_stagg_to_cntr">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">interp_stagg_to_cntr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">staggered_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/interpolate.html#interp_stagg_to_cntr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.interp_stagg_to_cntr" title="Link to this definition">#</a></dt>
<dd><p>Linearly interpolate values from staggered positions to cell-centered positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>staggered_values</strong> (<em>ndarray</em>)  Array of values at staggered positions.</p></li>
<li><p><strong>x_f</strong> (<em>ndarray</em>)  Positions of cell faces.</p></li>
<li><p><strong>x_c</strong> (<em>ndarray</em><em>, </em><em>optional</em>)  Positions of cell centers. If None, midpoints are used.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>)  Axis along which to interpolate. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated values at cell-centered positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.minmod">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">minmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#minmod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.minmod" title="Link to this definition">#</a></dt>
<dd><p>Applies the Minmod TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.muscl">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">muscl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#muscl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.muscl" title="Link to this definition">#</a></dt>
<dd><p>Applies the MUSCL TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.newton">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">newton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.49012e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/solve.html#newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.newton" title="Link to this definition">#</a></dt>
<dd><p>Perform Newton-Raphson iterations to solve nonlinear systems of equations.</p>
<p>This method iteratively refines an initial guess to find the root of a system
of nonlinear equations. It supports various linear solvers for handling the
Jacobian matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<em>callable</em>)  A function that takes the current solution estimate
and additional arguments, and returns a tuple containing the residual
vector and the Jacobian matrix.</p></li>
<li><p><strong>initial_guess</strong> (<em>ndarray</em>)  Initial guess for the solution vector.</p></li>
<li><p><strong>args</strong> (<em>tuple</em><em>, </em><em>optional</em>)  Additional arguments to pass to the <cite>function</cite>.
Default is an empty tuple.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>)  Convergence tolerance for the solution. Iterations
stop when the infinity norm of the update vector is less than <cite>tol</cite>.
Default is 1.49012e-08.</p></li>
<li><p><strong>maxfev</strong> (<em>int</em><em>, </em><em>optional</em>)  Maximum number of iterations allowed. Default is 100.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>optional</em>)  Linear solver to use for solving the Jacobian system.
Options are spsolve, cg, or bicgstab. If not specified, spsolve
is used for small systems (n &lt; 50000), and bicgstab for larger systems.</p></li>
<li><p><strong>callback</strong> (<em>callable</em><em>, </em><em>optional</em>)  A function called after each iteration with
the current solution estimate and residual vector as arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An object containing the following fields:</dt><dd><ul class="simple">
<li><p>x (ndarray): The solution vector.</p></li>
<li><p>success (bool): Whether the solver converged.</p></li>
<li><p>nit (int): Number of iterations performed.</p></li>
<li><p>fun (ndarray): The residual vector at the solution.</p></li>
<li><p>message (str): A message describing the termination status.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OptimizeResult</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong>  If an unsupported solver method is specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.non_uniform_grid">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">non_uniform_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx_inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/grid.html#non_uniform_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.non_uniform_grid" title="Link to this definition">#</a></dt>
<dd><p>Generate a non-uniform grid of points in the interval [left_bound, right_bound].</p>
<p>This grid allows gradual spacing adjustments, refining or coarsening the mesh
based on a stretching factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_bound</strong> (<em>float</em>)  Start of the domain interval.</p></li>
<li><p><strong>right_bound</strong> (<em>float</em>)  End of the domain interval.</p></li>
<li><p><strong>num_points</strong> (<em>int</em>)  Number of face positions (including boundaries).</p></li>
<li><p><strong>dx_inf</strong> (<em>float</em>)  Asymptotic grid spacing for distant points.</p></li>
<li><p><strong>factor</strong> (<em>float</em>)  Stretching factor (&gt;1 for expansion, &lt;1 for compression).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of non-uniformly spaced grid points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.osher">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">osher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#osher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.osher" title="Link to this definition">#</a></dt>
<dd><p>Applies the Osher TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.smart">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">smart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#smart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.smart" title="Link to this definition">#</a></dt>
<dd><p>Applies the SMART TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.stencil_block_diagonals">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">stencil_block_diagonals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_diagonals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/numjac.html#stencil_block_diagonals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.stencil_block_diagonals" title="Link to this definition">#</a></dt>
<dd><p>Generate a stencil pattern for block diagonals.</p>
<p>Parameters:
- ndims (int): Number of dimensions.
- axes_diagonals (list): Axes for diagonal dependencies.
- axes_blocks (list): Axes for block dependencies.
- periodic_axes (list): Axes with periodic boundaries.</p>
<p>Returns:
- list: Stencil pattern in PyMRM dependency notation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.stoic">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">stoic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#stoic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.stoic" title="Link to this definition">#</a></dt>
<dd><p>Applies the STOIC TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.translate_indices_to_larger_array">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">translate_indices_to_larger_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linear_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/coupling.html#translate_indices_to_larger_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.translate_indices_to_larger_array" title="Link to this definition">#</a></dt>
<dd><p>Translate linear indices from a subarray to their corresponding indices in a larger array.</p>
<section id="id5">
<h3>Parameters:<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>linear_indices<span class="classifier">array-like</span></dt><dd><p>Linear indices in the subarray.</p>
</dd>
<dt>shape<span class="classifier">tuple</span></dt><dd><p>Shape of the subarray.</p>
</dd>
<dt>new_shape<span class="classifier">tuple</span></dt><dd><p>Shape of the larger ND array.</p>
</dd>
<dt>offset<span class="classifier">tuple, optional</span></dt><dd><p>Offset of the subarrays top-left corner in the larger array (default: None).</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Returns:<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>:
np.ndarray</p>
<blockquote>
<div><p>Linear indices in the larger ND array.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.update_csc_array_indices">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">update_csc_array_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sparse_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/coupling.html#update_csc_array_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.update_csc_array_indices" title="Link to this definition">#</a></dt>
<dd><p>Update the row and column indices of a CSC-format sparse matrix to match a larger ND domain.</p>
<section id="id7">
<h3>Parameters:<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>sparse_mat<span class="classifier">scipy.sparse.csc_array</span></dt><dd><p>The input sparse matrix in CSC format.</p>
</dd>
<dt>shape<span class="classifier">tuple or ((tuple, tuple))</span></dt><dd><p>The original shape of the subdomain.</p>
</dd>
<dt>new_shape<span class="classifier">tuple or ((tuple, tuple))</span></dt><dd><p>The target shape of the larger domain.</p>
</dd>
<dt>offset<span class="classifier">tuple or ((tuple, tuple)), optional</span></dt><dd><p>The offset of the subdomain within the larger domain (default: None).</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns:<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>:
scipy.sparse.csc_array</p>
<blockquote>
<div><p>The updated sparse matrix with modified indices and shape.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.upwind">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">upwind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#upwind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.upwind" title="Link to this definition">#</a></dt>
<dd><p>Applies the upwind TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pymrm.vanleer">
<span class="sig-prename descclassname"><span class="pre">pymrm.</span></span><span class="sig-name descname"><span class="pre">vanleer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_c_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_x_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pymrm/convect.html#vanleer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymrm.vanleer" title="Link to this definition">#</a></dt>
<dd><p>Applies the van Leer TVD limiter to reduce oscillations in numerical schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_c_c</strong> (<em>ndarray</em>)  Normalized concentration at cell centers.</p></li>
<li><p><strong>normalized_x_c</strong> (<em>ndarray</em>)  Normalized position of cell centers.</p></li>
<li><p><strong>normalized_x_d</strong> (<em>ndarray</em>)  Normalized position of downwind face.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized concentration difference (c_norm_d - c_norm_C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pymrm/docs/sphinx"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.convect">pymrm.convect module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.clam"><code class="docutils literal notranslate"><span class="pre">clam()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.construct_convflux_bc"><code class="docutils literal notranslate"><span class="pre">construct_convflux_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.construct_convflux_upwind"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.construct_convflux_upwind_int"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.minmod"><code class="docutils literal notranslate"><span class="pre">minmod()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.muscl"><code class="docutils literal notranslate"><span class="pre">muscl()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.osher"><code class="docutils literal notranslate"><span class="pre">osher()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.smart"><code class="docutils literal notranslate"><span class="pre">smart()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.stoic"><code class="docutils literal notranslate"><span class="pre">stoic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.upwind"><code class="docutils literal notranslate"><span class="pre">upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.convect.vanleer"><code class="docutils literal notranslate"><span class="pre">vanleer()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.grid">pymrm.grid module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-generation-submodule-for-pymrm">Grid Generation Submodule for pymrm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.grid.generate_grid"><code class="docutils literal notranslate"><span class="pre">generate_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.grid.non_uniform_grid"><code class="docutils literal notranslate"><span class="pre">non_uniform_grid()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.helpers">pymrm.helpers module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.helpers.construct_coefficient_matrix"><code class="docutils literal notranslate"><span class="pre">construct_coefficient_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.helpers.unwrap_bc_coeff"><code class="docutils literal notranslate"><span class="pre">unwrap_bc_coeff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.interpolate">pymrm.interpolate module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.compute_boundary_values"><code class="docutils literal notranslate"><span class="pre">compute_boundary_values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.create_staggered_array"><code class="docutils literal notranslate"><span class="pre">create_staggered_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.interp_cntr_to_stagg"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.interp_cntr_to_stagg_tvd"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg_tvd()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interpolate.interp_stagg_to_cntr"><code class="docutils literal notranslate"><span class="pre">interp_stagg_to_cntr()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.numjac">pymrm.numjac module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.NumJac"><code class="docutils literal notranslate"><span class="pre">NumJac</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.NumJac.init_stencil"><code class="docutils literal notranslate"><span class="pre">NumJac.init_stencil()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.colgroup"><code class="docutils literal notranslate"><span class="pre">colgroup()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.compute_df"><code class="docutils literal notranslate"><span class="pre">compute_df()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.compute_df2"><code class="docutils literal notranslate"><span class="pre">compute_df2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.expand_dependencies"><code class="docutils literal notranslate"><span class="pre">expand_dependencies()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.generate_sparsity_pattern"><code class="docutils literal notranslate"><span class="pre">generate_sparsity_pattern()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.group_columns_by_non_overlap_numba"><code class="docutils literal notranslate"><span class="pre">group_columns_by_non_overlap_numba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.iterate_over_entries"><code class="docutils literal notranslate"><span class="pre">iterate_over_entries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.precompute_perturbations"><code class="docutils literal notranslate"><span class="pre">precompute_perturbations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.precompute_perturbations_numba"><code class="docutils literal notranslate"><span class="pre">precompute_perturbations_numba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.ravel_index_numba"><code class="docutils literal notranslate"><span class="pre">ravel_index_numba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.stencil_block_diagonals"><code class="docutils literal notranslate"><span class="pre">stencil_block_diagonals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.numjac.unravel_index_numba"><code class="docutils literal notranslate"><span class="pre">unravel_index_numba()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.operators">pymrm.operators module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_div"><code class="docutils literal notranslate"><span class="pre">construct_div()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_grad"><code class="docutils literal notranslate"><span class="pre">construct_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_grad_bc"><code class="docutils literal notranslate"><span class="pre">construct_grad_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.operators.construct_grad_int"><code class="docutils literal notranslate"><span class="pre">construct_grad_int()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm.solve">pymrm.solve module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.solve.clip_approach"><code class="docutils literal notranslate"><span class="pre">clip_approach()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.solve.newton"><code class="docutils literal notranslate"><span class="pre">newton()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pymrm">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.NumJac"><code class="docutils literal notranslate"><span class="pre">NumJac</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.NumJac.init_stencil"><code class="docutils literal notranslate"><span class="pre">NumJac.init_stencil()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.clam"><code class="docutils literal notranslate"><span class="pre">clam()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.clip_approach"><code class="docutils literal notranslate"><span class="pre">clip_approach()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.compute_boundary_values"><code class="docutils literal notranslate"><span class="pre">compute_boundary_values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_coefficient_matrix"><code class="docutils literal notranslate"><span class="pre">construct_coefficient_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_convflux_bc"><code class="docutils literal notranslate"><span class="pre">construct_convflux_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_convflux_upwind"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_convflux_upwind_int"><code class="docutils literal notranslate"><span class="pre">construct_convflux_upwind_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_div"><code class="docutils literal notranslate"><span class="pre">construct_div()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_grad"><code class="docutils literal notranslate"><span class="pre">construct_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_grad_bc"><code class="docutils literal notranslate"><span class="pre">construct_grad_bc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_grad_int"><code class="docutils literal notranslate"><span class="pre">construct_grad_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.construct_interface_matrices"><code class="docutils literal notranslate"><span class="pre">construct_interface_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.create_staggered_array"><code class="docutils literal notranslate"><span class="pre">create_staggered_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.generate_grid"><code class="docutils literal notranslate"><span class="pre">generate_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interp_cntr_to_stagg"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interp_cntr_to_stagg_tvd"><code class="docutils literal notranslate"><span class="pre">interp_cntr_to_stagg_tvd()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.interp_stagg_to_cntr"><code class="docutils literal notranslate"><span class="pre">interp_stagg_to_cntr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.minmod"><code class="docutils literal notranslate"><span class="pre">minmod()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.muscl"><code class="docutils literal notranslate"><span class="pre">muscl()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.newton"><code class="docutils literal notranslate"><span class="pre">newton()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.non_uniform_grid"><code class="docutils literal notranslate"><span class="pre">non_uniform_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.osher"><code class="docutils literal notranslate"><span class="pre">osher()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.smart"><code class="docutils literal notranslate"><span class="pre">smart()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.stencil_block_diagonals"><code class="docutils literal notranslate"><span class="pre">stencil_block_diagonals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.stoic"><code class="docutils literal notranslate"><span class="pre">stoic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.translate_indices_to_larger_array"><code class="docutils literal notranslate"><span class="pre">translate_indices_to_larger_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.update_csc_array_indices"><code class="docutils literal notranslate"><span class="pre">update_csc_array_indices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.upwind"><code class="docutils literal notranslate"><span class="pre">upwind()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymrm.vanleer"><code class="docutils literal notranslate"><span class="pre">vanleer()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By E.A.J.F. Peters and M. van Sint Annaland
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2025, TU/e.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>